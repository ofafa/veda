<%- include header %>
<body>
<p><a href="/medicine/addmed">Add new medicine</a></p>
<h3>前櫃</h3>
<% var dataTable = []; %>
<% medicines.forEach(function(medicine, index){ %>
<% if (medicine.position=='front') { %>
<% if (!dataTable[medicine.row]){ %>
<%     dataTable[medicine.row] = []; %>
<%     dataTable[medicine.row][medicine.col] = []; %>
<%     dataTable[medicine.row][medicine.col][medicine.index] = medicine.name %>
<% } %>
<% if(dataTable[medicine.row]){ %>
<%     if(!dataTable[medicine.row][medicine.col]){ %>
<%         dataTable[medicine.row][medicine.col] = []; %>
<%         dataTable[medicine.row][medicine.col][medicine.index] = medicine.name; %>
<%     } %>
<%     if(dataTable[medicine.row][medicine.col]){ %>
<%         dataTable[medicine.row][medicine.col][medicine.index] = medicine.name; %>
<%     }%>
<% }%>
<% } %>
<% }); %>

<table border="1">
    <% dataTable.forEach(function(col, index){ %>
    <tr>
        <%     col.forEach(function(box, index){ %>
        <td><%= box %></td>
        <%     }); %>
    </tr>
    <% });%>

</table>



<h3>後櫃</h3>
<% var dataTable = []; %>
<% medicines.forEach(function(medicine, index){ %>
    <% if (medicine.position=='back') { %>
        <% if (!dataTable[medicine.row]){ %>
        <%     dataTable[medicine.row] = []; %>
        <%     dataTable[medicine.row][medicine.col] = []; %>
        <%     dataTable[medicine.row][medicine.col][medicine.index] = medicine.name %>
        <% } %>
        <% if(dataTable[medicine.row]){ %>
        <%     if(!dataTable[medicine.row][medicine.col]){ %>
        <%         dataTable[medicine.row][medicine.col] = []; %>
        <%         dataTable[medicine.row][medicine.col][medicine.index] = medicine.name; %>
        <%     } %>
        <%     if(dataTable[medicine.row][medicine.col]){ %>
        <%         dataTable[medicine.row][medicine.col][medicine.index] = medicine.name; %>
        <%     }%>
        <% }%>
    <% } %>
<% }); %>

<table border="1">
    <% dataTable.forEach(function(col, index){ %>
    <tr>
    <%     col.reverse().forEach(function(box, index){ %>
           <td><%= box %></td>
    <%     }); %>
    </tr>
    <% });%>

</table>

<div class="backbox">
    <div id="bb-c1">
        <div id="bb-c1-r1"></div>
        <div id="bb-c1-r2"></div>
        <div id="bb-c1-r3"></div>
        <div id="bb-c1-r4"></div>
    </div>
</div>

<h3>庫存</h3>
<% medicines.forEach(function(medicine, index){ %>
<a href='/medicine/medinfo/<%= medicine.name %>'><%= medicine.name %></a>
    <% if (medicine.position=='stock') { %>
        <p><a href="/medicine/<%= medicine.name %>"><%= medicine.name %></a></p>
    <% } %>

<% }) %>

</body>